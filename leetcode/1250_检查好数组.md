---
created: 2023-02-16 09:05
aliases: []
tags:
  - leetcode 
  - number_theory 
---

# Description

给你一个正整数数组 `nums`，你需要从中任选一些子集，然后将子集中每一个数乘以一个 **任意整数**，并求出他们的和。

假如该和结果为 `1`，那么原数组就是一个「**好数组**」，则返回 `True`；否则请返回 `False`。


# Solution

## 数论

首先注意到，存在一个子集满足题设，等价于在全局大小满足题设，只需要将子集之外的系数取为$0$即可。所以题目等价于判断给定数组$[a_1, a_2, \dots, a_n]$，构造关于$x_i$的方程。

$$
	\sum_{i = 1}^n a_i x_i = 1
$$
问，方程是否存在整数解。

两个的情况下，即为贝祖定理的应用，当且仅当$\text{gcd}(a_1, a_2) = 1$时，以上方程有解。(证明是从两数字取其中一个为除数，另一个构成的同余量，乘上不同的$x_i$结果构成的环导出)

合理推广猜测答案是$\text{gcd}(a_1, a_2, \dots, a_n) = 1$时为`True`，否则`False`。

先检查边界情况，在数组只有1个数的时候，$\text{gcd}(a_1) = a_1$，也确实是当且仅当$a_1 = 1$时才能返回`True`

多个的情况下，有复杂一些的证明。

必要性：

不妨设$\text{gcd}(a_1, a_2, \dots, a_n) = g, a_i' = a_i / g$，原方程变为$(\sum_{i=1}^n a_i'x_i)g = 1$，$\sum_{i=1}^n a_i'x_i$和$g$都为整数，相乘为$1$当且仅当二者同为$1$或者同为$-1$，从$\text{gcd}$的定义，则只有同为$1$的可能，即证必要性

充分性：

注意到$\text{gcd} (a_1, a_2, ..., a_n) = \text{gcd} (\text{gcd}(a_1, a_2, \dots, a_{n - 1}), a_n)$，而两数贝祖原理可以等价于说$a_1x_1 +a_2x_2$只能等于$\text{gcd} (a_1, a_2)$的倍数，而将方程前两项，替换成$k$倍的$\text{gcd}(a_1,a_2)$，解的结构不改变，所以逐次应用两数的贝祖原理，然后从多个数的$\text{gcd}$的定义，结合$\text{gcd} (a_1, a_2, ..., a_n)=1$，即证充分性

时间复杂度$O(n)$，空间复杂度$O(1)$


```python
class Solution:
    def isGoodArray(self, nums: List[int]) -> bool:
        return gcd(*nums) == 1
```
